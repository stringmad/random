


create table  TV_Royalty_run_control_CD(
extractrunnumber        bigint,
extractstarttimestamp   timestamp,
edmhiveviewname         string ,
interfaceversion        string,
sourcesystem            string,
originatingsystem       string  ,
extractrangestartdate   timestamp ,
extractrangeenddate     timestamp,
recordcount             bigint ,
totalamount             decimal(15,3)
)
row format delimited fields terminated by '/001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/RUN_Control_CONTENTDEVICE';

create table  TV_Royalty_run_control_CP(
extractrunnumber        bigint,
extractstarttimestamp   timestamp,
edmhiveviewname         string ,
interfaceversion        string,
sourcesystem            string,
originatingsystem       string  ,
extractrangestartdate   timestamp ,
extractrangeenddate     timestamp,
recordcount             bigint ,
totalamount             decimal(15,3)
)
row format delimited fields terminated by '/001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/RUN_Control_CONTENTPRODUCT';


create table  TV_Royalty_run_control_UP(
extractrunnumber        bigint,
extractstarttimestamp   timestamp,
edmhiveviewname         string ,
interfaceversion        string,
sourcesystem            string,
originatingsystem       string  ,
extractrangestartdate   timestamp ,
extractrangeenddate     timestamp,
recordcount             bigint ,
totalamount             decimal(15,3)
)
row format delimited fields terminated by '/001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/RUN_Control_USERPROFILE';


create table  TV_Royalty_run_control_CPU(
extractrunnumber        bigint,
extractstarttimestamp   timestamp,
edmhiveviewname         string ,
interfaceversion        string,
sourcesystem            string,
originatingsystem       string  ,
extractrangestartdate   timestamp ,
extractrangeenddate     timestamp,
recordcount             bigint ,
totalamount             decimal(15,3)
)
row format delimited fields terminated by '/001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/RUN_Control_CONTENTPURCHASE';

create table  TV_Royalty_run_control_VP(
extractrunnumber        bigint,
extractstarttimestamp   timestamp,
edmhiveviewname         string ,
interfaceversion        string,
sourcesystem            string,
originatingsystem       string  ,
extractrangestartdate   timestamp ,
extractrangeenddate     timestamp,
recordcount             bigint ,
totalamount             decimal(15,3)
)
row format delimited fields terminated by '/001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/RUN_Control_VODPLAY';

--------------------------------------------------------------------
CREATE  External table VW_EDW_VOSP_REP_CONTENTDEVICE
(
DeviceID String,
DeviceGUID String,
VSID String,
MACAddress String,
ClientDRMID String,
SerialNumber String,
DeviceStatus String,
DeviceServiceType String,
RegistrationIP String,
LastIP String,
LastIPChange_DT  date,
DeviceMake String,
DeviceModel String,
ClientServiceVariant String,
DeviceCreated_DT date,
DeviceUpd_DT date,
DeviceLastAssociate_DT date,
DeviceLastReset_DT date,
DeviceLastTrusted_DT date,
CN String,
OU String,
DeviceSoftwareVersion String,
DeviceAppVersion String,
useragentstring String,
ClientEventReporting String,
ClientEventReportingState String,
DeviceClass String,
DeviceAuthorisationStatus String,
DeviceAuthorisation_DT date,
DeviceAuthorisationReset_DT date,
deviceauthorisationupdatedby String,
DeviceDeAuthorisation_DT date,
DeviceFriendlyName String,
ClientPlatform String,
DeviceAppType String,
ObjectStatus String,
DM_Report_DT String,
HaaS_Created_DT date
)
partitioned by (edw_date String  )
row format delimited fields terminated by ','
stored as textfile
 LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/CONTENTDEVICE';
--------------------------------------------------------------------------
create external table VW_EDW_VOSP_REP_CONTENTPURCHASE
(
eventid string,
LedgerTransaction_DT date,
PurchaseID String,
OrderSummaryID String,
OrderItemID String,
EventCorrelationID String,
EventType String,
EventStatusCode String,
EventStatus String,
EventStatusDescription String,
TotalAmount String,
Currency String,
VSID	 String,
AccountType String,
ControlGroup String,
AccountStatus String,
LineAccountID String,
PurchasingDeviceID String,
DeviceGUID String,
UUID	 String,
DeviceServiceType String,
DeviceClass String,
DeviceStatus String,
DeviceMake String,
DeviceModel String,
DeviceVariant String,
DeviceSoftwareVersion String,
UserAgentString String,
ClientPlatform String,
DeviceAppType String,
EntitledDeviceID String,
EntitledHouseholdID String,
RentalPeriod String,
ClientAssetID String,
ProductID String,
ProductTitle String,
TitleDefault String,
AssetTitleID String,
LinkedTitleID String,
StructureType String,
ParentGUID String,
ParentTitle String,
CollectionBundleCount String,
EditorialVersionId String,
PlaylistType String,
ProductOfferingType String,
SchedulerChannel String,
Genre	 String,
TargetBandwidth String,
ContentRating String,
ContentProviderID String,
ContentProviderName String,
RecommendationGUID String,
PlacementID String,
ClientIP String,
ISPType	 String,
NetworkType String,
GeoLocation String,
LineReliabilityIndex String,
LineReliabilityStatus String,
LineLastVerification_DT Date,
LineEarliestTrust_DT Date,
RoyaltyEventCategory String,
RoyaltyReportingReference String,
RepContentID String,
RoyaltyReportingTitle String,
RoyaltyEventViewType String,
RoyaltyPrimaryEventID String,
EventSubType String,
Net_TotalAmount String,
ContractID String,
PlyLstChildClientAssetID String,
PlyLstChildClientAssetTitleID String,
PlaylistChildrenList String,
PlaylistChildrenCount String,
UniqueDeviceID String,
DiscoveryObjectType String,
DiscoveryObjectTitle String,
ParentProductEditorialVersion String,
ParentDiscoveryObjectGUID String,
ParentDiscoveryObjectType String,
ParentDiscoveryObjectTitle String,
GrandparentDiscoveryObjGUID String,
GrandparentDiscoveryObjType String,
GrandparentDiscoveryObjTitle String,
MediaAssetID String,
EntitlementType String,
DM_Report_DT Date,
HaaS_Created_DT Date
)
PARTITIONED BY (part_date STRING)
row format delimited fields terminated by '\001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/CONTENTPURCHASE';
--------------------------------------------------
create table VW_EDW_VOSP_REP_CONTENTPRODUCT
(ProductID String,
ProductGUID String,
ClientAssetID String,
AssetTitleID String,
VOSP1ProductID String,
ContractID String,
EditorialVersionID String,
StructureType String,
ProductType String,
ProductOfferringType   String,
SchedulingID String,
ProductPlaylistType String,
StorefrontProductID String,
ValidForStorefront String,
ParentGUID String,
ProductAdded_DT Date,
ProductUpdated_DT Date,
OfferStart_DT Date,
OfferEnd_DT Date,
MasterAgrementStart_DT Date,
MasterAgrementEnd_DT Date,
ContentProviderID String,
RoyaltyReportingReference String,
LinkedAssetTitleID String,
ProductOfferings String,
ProductDuration String,
RentalPeriod String,
Subscriptions String,
ScopeIDs String,
AudioLanguage String,
AudioDescription String,
CollectionBundleCount String,
BundleProductIDs String,
PricingTemplate String,
InhibitProduct String,
SeriesNumber String,
EpisodeNumber String,
Amounts Float,
ProductServiceType String,
TargetBandwidth String,
Genre String,
SchedulerChannel String,
Rating String,
RatingAuthority String,
ProductTitle String,
TitleDefault String,
TitleSearch String,
BBJ_TitleName String,
BBJ_SeriesTitle String,
BBJ_ExternalID String,
BBJ_RoyaltyCategory String,
BBJ_RoyaltyContract String,
BBJ_Licensor String,
BBJ_FirstBroadcaster String,
BBJ_EIDR String,
BBJ_Artist String,
BBJ_ISAN String,
BBJ_ISRC String,
BBJ_MCPS_PRS_PPL String,
BBJ_MSC String,
BBJ_Promo_List String,
BBJ_ServiceList String,
BBJ_ViewFormat String,
BBJ_ChannelName String,
BBJ_Added_DT Date,
BBJ_Updated_DT Date,
BBJ_Type String,
BBJ_PlaylistType String,
DEALS_ConsolidatedInfo String,
PLAYLIST_SchedulingID String,
PLAYLIST_ContentProviderID String,
PLAYLIST_NumberOfChildren String,
PLAYLIST_ChildrenList String,
PLAYLIST_Duration String,
PLAYLIST_Added_DT Date,
PLAYLIST_Updated_DT Date,
RoyaltyReportingTitle String,
BBJ_PromoType String,
SubGenres String,
Grade_Flag String,
Grade_Category String,
MG_Flag String,
EpisodeTitle String,
MediaAssetID String,
DM_Report_DT Date,
HaaS_Created_DT Date
)
PARTITIONED BY (part_date STRING)
row format delimited fields terminated by '\001'
stored as textfile
LOCATION 
'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/CONTENTPRODUCT';
--------------------------------------------------------------------------
CREATE external table VW_EDW_VOSP_REP_USERPROFILE 
(
userprofileid string,
userprofileguid   string,
vsid string,
btwsid string,
rbsid string,
ordernumber string,
accounttype string,
accountstatus string,
subscriptions string,
account_created_dt date,
account_updated_dt date,
controlgroup string,
householdid string,
recommendationtype string,
rating string,
parentalcontrolratings string,
purchasepinenabled string,
sharedpin string,
adultpin string,
clashmanagementpolicy string,
objectstatus string,
dm_report_dt date,
haas_created_dt date
)
partitioned by (edw_date string )
row format delimited fields terminated by ','
stored as textfile
LOCATION 
'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/USERPROFILE';
-------------------------------------------------------------
CREATE  table VW_EDW_VOSP_REP_VODPLAY 
(
EventID String,
EventCorrelationID String,
EventType String,
EventStart_DT Date,
EventEnd_DT Date,
EventDuration String,
EventSlotType String,
EventSubType String,
EventStatusCode String,
EventStatus String,
EventStatusDescription String,
EventSessionID String,
PlayPresentType String,
VSID String,
AccountType String,
ControlGroup String,
AccountStatus String,
LineAccountID String,
HouseholdID String,
ClientID String,
PurchasingDeviceID String,
DeviceGUID String,
UUID String,
DeviceServiceType String,
DeviceClass String,
DeviceStatus String,
MACAddress String,
DeviceMake String,
DeviceModel String,
DeviceVariant String,
DeviceAppVersion String,
DeviceSoftwareVersion String,
UserAgentString String,
ClientPlatform String,
DeviceAppType String,
DisplayDeviceGUID String,
DisplayDeviceType String,
DisplayDeviceModel String,
DisplayDeviceVersion String,
ClientAssetID String,
MediaAssetID String,
AssetTitleID String,
AssetTitle String,
AssetType String,
AssetDuration String,
SchedulerChannel String,
Genre String,
SubGenres String,
TargetBandwidth String,
ProductID String,
ProductOfferingType String,
AssetReleaseID String,
AssetReleasePID String,
ParentGUID String,
ParentTitle String,
EpisodeNumber String,
SeriesNumber String,
BundleCount String,
EditorialVersionID String,
ContentProviderID String,
ContentProviderName String,
ContractID String,
CDNType String,
isURLSigned String,
EntitlementType String,
MatchedSCodes String,
RecommendationGUID String,
PlacementID String,
PlaylistType String,
ConcurrencyPolicyID String,
ConcurrencyPolicyName String,
ConcurrencyClientID String,
LockID String,
LockStart_DT Date,
ClientIP String,
ISPType String,
NetworkType String,
GeoLocation String,
LineReliabilityIndex String,
LineReliabilityStatus String,
LineLastVerification_DT date,
LineEarliestTrust_DT date,
RoyaltyEventViewType String,
RoyaltyEventCategory String,
RoyaltyPrimaryEventID String,
RoyaltyReportingReference String,
RepContentID String,
RoyaltyReportingTitle String,
PlyLstChildClientAssetID String,
PlyLstChildClientAssetTitleID String,
PlaylistChildrenList String,
PlaylistChildrenCount String,
PrimaryMatchedSCode String,
UniqueDeviceID String,
DiscoveryObjectType String,
DiscoveryObjectTitle String,
ParentProductEditorialVersion String,
ParentDiscoveryObjectGUID String,
ParentDiscoveryObjectType String,
ParentDiscoveryObjectTitle String,
GrandparentDiscoveryObjGUID String,
GrandparentDiscoveryObjType String,
GrandparentDiscoveryObjTitle String,
DM_Report_DT date,
HaaS_Created_DT date,
partition_date string )
PARTITIONED BY (part_date STRING)
row format delimited fields terminated by '\001'
stored as textfile
LOCATION 'hdfs://nameservice1/user/HAASAAP0063/landing/staging/TVRoyalty/VODPLAY';
